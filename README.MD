
# Projet API STEAM

---

## üöÄ Membres du projet

| Nom                  | Identifiant  |
|----------------------|--------------|
| FAGOT--NAUDE Am√©lien | fago0014     |
| PIERRON Matteo       | pier0270     |

---

## ‚öôÔ∏è Initialisation du projet

Ce projet n√©cessite **Composer** pour g√©rer les d√©pendances.

1. Assurez-vous que Composer est install√© et configur√© (source ~/.profile pour Linux/macOS).
2. Installez les d√©pendances :

```bash
composer install
```

3. G√©n√©rez l'autoloader √† jour :

```bash
composer dump-autoload
```

---

## ‚ñ∂Ô∏è Lancement du serveur web

- **Windows**

```bash
composer start:windows
```

- **Linux**

```bash
composer start
# ou
composer start:linux
```

---

## üìÅ Contenu du projet

Le projet s‚Äôappuie sur un extrait de l‚ÄôAPI Steam pour afficher des informations sur les jeux vid√©o.

### Pages principales

- **index.php**  
  Affiche la liste des **genres** et des **cat√©gories** pr√©sents dans l‚Äôextrait Steam.

- **genre.php / categorie.php**  
  Liste les jeux appartenant √† un genre ou une cat√©gorie sp√©cifique.  
  Pour chaque jeu, vous verrez :
  - Poster
  - Nom
  - Ann√©e
  - Description
  - Boutons pour trier par titre ou par ann√©e
  - Bouton retour √† l'accueil (index.php)

- **game.php**  
  Affiche les d√©tails d‚Äôun jeu s√©lectionn√© :
  - Prix
  - Poster
  - Ann√©e
  - D√©veloppeur
  - Note
  - Description
  - Plateformes disponibles
  - Cat√©gories et genres associ√©s
  - Bouton **Supprimer** pour retirer ce jeu de la base de donn√©es
  - Bouton retour √† l'accueil

---

## üìå Fonctionnalit√©s cl√©s

- Navigation fluide entre genres, cat√©gories et d√©tails des jeux
- Tri dynamique des listes de jeux par titre ou par ann√©e
- Gestion simplifi√©e via suppression directe d‚Äôun jeu depuis sa fiche

---

## üìå Formulaire

## 1. Formulaire de modification (game_modif.php)

Le formulaire affiche les donn√©es actuelles d‚Äôun jeu (nom, ann√©e, description, prix, plateformes, metacritic, d√©veloppeur, affiche, cat√©gories, genres)  
L‚Äôutilisateur modifie ces donn√©es, puis soumet le formulaire en POST vers game_modif_post.php.

---

## 2. Traitement du formulaire (game_modif_post.php)

- R√©cup√©ration des donn√©es POST avec conversion stricte (int, float).
- Validation simple des champs obligatoires.
- Chargement de l‚Äôentit√© Game existante via GameCollection::findById($id).
- Mise √† jour des propri√©t√©s de l‚Äôobjet Game avec les setters.
- Conversion du prix en centimes (int).
- Conversion des plateformes (checkboxes) en 0/1.
- Gestion du score Metacritic (par d√©faut 0 si vide).
- Gestion des associations cat√©gories et genres :
  - Suppression des anciennes via deleteByGameId($id)
  - Insertion des nouvelles via insert($id, $categoryId) ou insert($id, $genreId)
- Appel √† la m√©thode save() de l‚Äôobjet Game pour mise √† jour en base.
- Redirection vers la page de modification avec l‚ÄôID en param√®tre.

---

## 3. M√©thodes cl√©s

### GameCollection

- findById(int $id): ?Game ‚Äî r√©cup√®re un jeu par son ID.

### GameCategoryCollection

- deleteByGameId(int $gameId): void ‚Äî supprime toutes les cat√©gories li√©es.
- insert(int $gameId, int $categoryId): void ‚Äî ajoute une association cat√©gorie.

### GameGenreCollection

- deleteByGameId(int $gameId): void ‚Äî supprime toutes les associations genres.
- insert(int $gameId, int $genreId): void ‚Äî ajoute une association genre.

### Game (entit√©)

- Setters : setName(), setReleaseYear(), setShortDescription(), setPrice(), setWindows(), setLinux(), setMac(), setMetacritic(), setDeveloperId(), setPosterId().
- save(): void ‚Äî met √† jour les donn√©es du jeu dans la base.

---

## 4. Bonnes pratiques

- Valider et typer strictement les donn√©es du formulaire.
- Ne jamais modifier la cl√© primaire lors d‚Äôune modification.
- Supprimer les anciennes associations avant insertion des nouvelles pour √©viter les doublons.
- Convertir les bool√©ens en entiers avant stockage.
- Utiliser des transactions PDO pour garantir la coh√©rence (recommand√© en production).

---

## 5. Workflow r√©sum√©

1. Affichage du formulaire avec donn√©es existantes.
2. Soumission du formulaire modifi√©.
3. Validation et mise √† jour de l‚Äôobjet Game.
4. Suppression et r√©insertion des cat√©gories et genres.
5. Sauvegarde finale en base.
6. Redirection vers la page de modification.

---

## üìå Arboescence du projet

/bin  
run-server.bat          # Script Windows pour d√©marrer le serveur  
run-server.sh           # Script Linux/macOS pour d√©marrer le serveur

/public  
/css  
style.css           # Feuille de styles CSS globale du projet  
/Form  
game_add.php        # Formulaire d'ajout d'un jeu  
game_create_post.php # Traitement POST de cr√©ation d'un jeu  
game_delete.php     # Suppression d'un jeu  
game_modif.php      # Formulaire de modification d'un jeu  
game_modif_post.php # Traitement POST de modification d'un jeu  
game_select.php     # Liste ou s√©lection de jeux  
/svg  
apple.svg           # Ic√¥ne Apple/macOS  
linux.svg           # Ic√¥ne Linux  
windows.svg         # Ic√¥ne Windows  
categorie.php           # Gestion des cat√©gories  
game.php                # Fichier principal li√© aux jeux (logique m√©tier ?)  
genre.php               # Gestion des genres  
index.php               # Page d'accueil ou route principale

/src  
/Database  
MyPdo.php           # Classe singleton PDO pour la connexion √† la base de donn√©es

/Entity  
/Collection  
CategorieCollection.php       # Gestion des collections de cat√©gories (CRUD)  
GameCategoryCollection.php   # Gestion des relations jeu-cat√©gorie  
GameCollection.php           # Gestion des jeux (CRUD)  
GameGenreCollection.php      # Gestion des relations jeu-genre  
GenderCollection.php         # Gestion des genres (CRUD)  
/Exception  
AppWebPage.php               # Gestion des exceptions personnalis√©es  
Categorie.php                # Entit√© cat√©gorie  
Developer.php                # Entit√© d√©veloppeur  
Game.php                     # Entit√© jeu, contient la logique m√©tier et les setters/getters  
Gender.php                   # Entit√© genre  
Poster.php                   # Entit√© poster (image ou affiches ?)  
/Html  
StringEscaper.php               # Classe utilitaire pour √©chapper les cha√Ænes HTML  
WebPage.php                    # Classe pour g√©n√©rer les pages web dynamiques
